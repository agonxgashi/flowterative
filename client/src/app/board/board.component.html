
<app-loading *ngIf="isLoadingBoard"></app-loading>
<div *ngIf="board">
  <div class="row p-0 m-0">

    <div class="col-md-3">
      <div class="sidebar sidenav col-md-3 bg-light">

        <div class="d-flex w-100 justify-content-between pt-3">
          <button type="button" class="btn btn-sm btn-light" [routerLink]="['/boards']">
            <i class="fa fa-angle-double-left pr-2"></i> {{ 'GENERAL.Back' | translate}}
          </button>
          <button type="button" (click)="getBoardDetails()" class="btn btn-sm btn-light" data-toggle="modal"
            data-target="#board-settings-modal">
            {{ 'BOARD.Settings' | translate}} <i class="pl-2 fa fa-cog"></i>
          </button>

        </div>
        <hr>
        <div class="d-flex w-100 justify-content-between">
          <h5>Backlog</h5>
          <button type="button" (click)="getBoardDetails()" class="btn btn-sm btn-light" data-toggle="modal"
            data-target="#add-new-task-modal">
            {{'TASK.New' | translate}} <i class="fa fa-plus pl-2"></i>
          </button>
        </div>




        <ul class="list-group">
          <li class="list-group-item d" id="{{board.Backlog._id}}" [dragula]='"bag-one"'>
            <span *ngFor="let task of board.Backlog.Tasks" id="{{task._id}}" href="#" class="list-group-item list-group-item-action align-items-start clickable">
              <div class="d-flex w-100 justify-content-between ">
                <!-- Task title -->
                <h5 class="mb-1 mr-2">
                  {{task.Name}}
                </h5>
                <!-- Task autogenerated incremental ID (hashtag) -->
                <p class="badge badge-pill badge-warning px-2 py-1">
                  #624615
                </p>
              </div>
              <!-- Task description -->
              <p class="mb-1 mt-1
               text-muted">
                {{task.Description}}
              </p>
              <div class="d-flex justify-content-between mt-3">
                <!-- Task Due date -->
                <small class="text-muted">
                  Due: Monday, June 15, 2018 at 9:03:01 AM
                </small>
                <!-- Task tags represented by selected colors -->
              </div>
            </span>

          </li>
        </ul>
      </div>
    </div>



    <div *ngIf="board" class="p-5 d-flex col-md-9 justify-content-start">
      <div class="clear"></div>
      <pre>{{ board | json}}</pre>
      <div *ngFor="let list of board_lists" class="list-group col-md-3">
        <span href="#" class="list-group-item list-group-item-action flex-column align-items-start bg-{{board.Color}}">
          <div class="d-flex w-100 justify-content-between">
            <h6 class="mb-1 text-light"> {{ list.Name }} {{ list._id }} </h6>
            <!-- <small class="btn-primary btn btn-sm" data-toggle="modal" data-target="#add-new-task-modal">
          <i class="fa fa-plus text-light"></i>
        </small> -->
            <!-- <i> sd </i> -->
          </div>
        </span>
        <div class="list-content" id="{{list._id}}" [dragula]='"bag-one"'>

          <span *ngFor="let task of list.Tasks" id="{{task._id}}" href="#" class="list-group-item list-group-item-action flex-column align-items-start clickable">
            <div class="d-flex w-100 justify-content-between ">
              <!-- Task title -->
              <h5 class="mb-1 mr-2">
                {{task.Name}}
              </h5>
              <!-- Task autogenerated incremental ID (hashtag) -->
              <p class="badge badge-pill badge-warning px-2 py-1">
                #624615
              </p>
            </div>
            <!-- Task description -->
            <p class="mb-1 mt-1 text-muted">
              {{task.Description}}
            </p>
            <div class="d-flex justify-content-between mt-3">
              <!-- Task Due date -->
              <small class="text-muted">
                Due: Monday, June 15, 2018 at 9:03:01 AM
              </small>
              <!-- Task tags represented by selected colors -->
            </div>
          </span>

        </div>
      </div>
    </div>

  </div>



  <!-- MODAL: Add new task -->
  <div class="modal fade" id="add-new-task-modal" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">{{'TASK.New' | translate}}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6">
              <label for="">{{'TASK.Title'}}</label>
              <input type="text" placeholder="Title" [(ngModel)]="taskToAdd.Name" class="form-control">
              <br>
              <label for="">{{'TASK.Description'}}</label>
              <textarea class="form-control" [(ngModel)]="taskToAdd.Description" name="tasktoadddescription" cols="30"
                rows="4" placeholder="Description"></textarea>
              <br>
              <label for="">{{'TASK.From'}}</label>
              <input type="date" id="datepicker-example" [(ngModel)]="taskToAdd.StartDate" placeholder="From" class="form-control">
              <br>
              <label for="">{{'TASK.Due'}}</label>
              <input type="date" id="datepicker-example" [(ngModel)]="taskToAdd.DueDate" placeholder="To" class="form-control">

            </div>
            <div class="col-md-6">
              <label for="">{{'TASK.Assign'}}</label>
              <input type="text" class="form-control" placeholder="Assign">
              <br>
              <label for="">{{'TASK.Steps'}}</label>
              <input type="text" placeholder="Add Steps" [(ngModel)]="subtaskToAdd.Content" (keyup.enter)="addSubtask()"
                class="form-control">
              <ul style="list-style: none;" *ngIf="taskToAdd">
                <li *ngFor="let st of taskToAdd.Steps; let i = index">
                  <i class="fa fa-times text-danger pr-2" (click)="removeSubtask(i)"></i> {{ st.Content }}
                </li>
              </ul>
            </div>
            {{ taskToAdd | json }}
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="addNewTask()">Save</button>
        </div>
      </div>
    </div>
  </div>


  <!-- MODAL: Board Settings -->
  <div *ngIf="board" class="modal fade" id="board-settings-modal" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
    aria-hidden="true">
    <div class="modal-dialog  modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">{{ board.Name }} • {{'BOARD.Settings' | translate}}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6 text-center">
              <small class="text-muted">
                Arrange list order by draging below containers
              </small>
              <br>
              <br>
              <div class="col-md-12" [dragula]='"bag-board-list-arrange"'>
                <div class="bg-light p-4 mb-1 rounded text-center" *ngFor="let list of board.Lists">
                  {{list.Name}}
                </div>
              </div>
              <div class="col-md-12">
                <div data-toggle="modal" data-target="#new-board-modal" class="p-3 btn btn-outline-primary btn-block mt-2 rounded  text-center">
                  {{'LIST.CreateNew' | translate}}
                </div>
              </div>

            </div>
            <div class="col-md-6">
              <label for="">{{'BOARD.Name' | translate}}</label>
              <br>
              <input type="text" [(ngModel)]="board.Name" class="form-control">
              <br>
              <label for="">{{'BOARD.Description' | translate}}</label>
              <br>
              <textarea class="form-control" [(ngModel)]="board.Description" cols="30" rows="10"></textarea>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">
            <i class="fa fa-ban"> </i> {{'GENERAL.Cancel' | translate}} </button>
          <button type="button" class="btn btn-success" data-dismiss="modal">
            <i class="fa fa-save"> </i> {{'GENERAL.Save' | translate}} </button>
        </div>
      </div>
    </div>
  </div>


  <!-- MODAL: Create new list -->
  <div class="modal fade" id="new-board-modal" tabindex="-1" role="dialog" aria-labelledby="new-board-modal"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Creating new board</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">

          <label for="">Board Name</label>
          <input type="text" [(ngModel)]="listToCreate.Name" name="listToCreateName" class="form-control">

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">
            <i class="fa fa-ban"> </i> Cancel </button>
          <button [disabled]="!listToCreate.Name" type="button" class="btn btn-success" data-dismiss="modal" (click)="addList()">
            <i class="fa fa-save"> </i> Save </button>
        </div>
      </div>
    </div>
  </div>
</div>